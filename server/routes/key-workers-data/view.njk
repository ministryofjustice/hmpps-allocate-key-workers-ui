{% extends "partials/layout.njk" %}
{% from "moj/components/date-picker/macro.njk" import mojDatePicker %}
{% from "govuk/components/details/macro.njk" import govukDetails %}

{% set fullWidth = true %}
{% set pageTitle = "Key Workers Data" %}

{% block innerContent %}

  <h1 class="govuk-heading-l">Key Workers Data for</h1>

  <hr class="govuk-footer__section-break" />

  <h2 class="govuk-heading-m">Select a date range to view</h2>

  <div class="govuk-!-margin-bottom-4">
    <div class="govuk-!-display-inline-block">
      <form method="post">
        <input type="hidden" name="_csrf" value="{{ csrfToken }}" />
        {{ mojDatePicker({
          id: "dateFrom",
          name: "dateFrom",
          label: {
            text: "From"
          },
          value: dateFrom,
          maxDate: todayStringGBFormat()
        }) }}

        {{ mojDatePicker({
          id: "dateTo",
          name: "dateTo",
          label: {
            text: "To"
          },
          value: dateTo,
          maxDate: todayStringGBFormat()
        }) }}
      </form>
    </div>
  </div>

  <hr class="govuk-footer__section-break" />

  {% if data.length %}

    <p>Displaying statistics from {{ dateFrom | dateString }} to {{ dateTo | dateString }}.
      {% if hasPreviousStats %}Comparing against statistics from {{ comparisonDateFrom | dateString }} to {{ comparisonDateTo | dateString }}. {% endif %}</p>

    <div class="govuk-grid-row">
      {% for statistic in data %}
        <div class="govuk-grid-column-one-half">
          <h2 class="govuk-heading-s">{{ statistic.heading }}</h2>
          {{ govukDetails({
            summaryText: "Help this data is calculated",
            text: "We need to know your nationality so we can work out which elections you’re entitled to vote in. If you cannot provide your nationality, you’ll have to send copies of identity documents through the post."
          }) }}
          <p class="govuk-!-font-size-36">{{ statistic.value }}</p>
          {% if hasPreviousStats %}<p>{{ statistic.change.value }}</p>{% endif %}
        </div>
      {% endfor %}
    </div>
  {% else %}
    <h2 class="govuk-heading-s">There is no data for this period.</h2>
  {% endif %}

{% endblock %}
